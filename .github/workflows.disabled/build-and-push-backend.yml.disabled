# name: Build and Push Backend

# on:
#   push:
#     branches: [main]
#     paths:
#       - "OxygenBackend/**"
#       - ".github/workflows/build-backend.yml"
#   workflow_dispatch:

# env:
#   AWS_REGION: eu-central-1
#   BACKEND_IMAGE: oxygenquiz/backend

# jobs:
#   build-and-push-backend:
#     runs-on: ubuntu-latest
#     permissions:
#       contents: read
#       id-token: write
#     steps:
#       - uses: actions/checkout@v4
#       - uses: docker/setup-buildx-action@v3
#       - uses: aws-actions/configure-aws-credentials@v4
#         with:
#           role-to-assume: ${{ secrets.AWS_ROLE_TO_ASSUME }}
#           aws-region: ${{ env.AWS_REGION }}
#       - uses: aws-actions/amazon-ecr-login@v2
#         id: login-ecr
#       - run: |
#           docker buildx build \
#             --platform linux/amd64 \
#             --file OxygenBackend/Dockerfile \
#             --tag ${{ steps.login-ecr.outputs.registry }}/${{ env.BACKEND_IMAGE }}:${{ github.sha }} \
#             --tag ${{ steps.login-ecr.outputs.registry }}/${{ env.BACKEND_IMAGE }}:latest \
#             --push \
#             OxygenBackend
